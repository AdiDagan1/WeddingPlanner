<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ניהול תקציב</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            text-align: right;
            margin: 20px;
            background-color: #f4f4f9;
        }
        h1 {
            color: #333;
        }
        .budget-container {
            max-width: 600px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            padding: 10px 15px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .budget-summary {
            margin-top: 20px;
            padding: 10px;
            background: #e9f7ef;
            border: 1px solid #b8e4c9;
            border-radius: 4px;
        }
        .expense-list {
            margin-top: 20px;
        }
        .expense-list ul {
            list-style-type: none;
            padding: 0;
        }
        .expense-list li {
            background: #f9f9f9;
            margin: 5px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .expense-actions {
            display: flex;
            gap: 10px;
        }
        .expense-actions span {
            cursor: pointer;
            font-size: 18px;
            color: #007bff;
        }
        .expense-actions span:hover {
            color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="budget-container">
        <h1>ניהול תקציב</h1>
    
        <!-- חלק התקציב הראשוני -->
        <div class="form-group" id="budget-input-group">
            <label for="total-budget">סך התקציב:</label>
            <input type="text" id="total-budget" placeholder="הזן את סך התקציב שלך" required>
            <button type="button" id="set-budget">שמור תקציב</button>
        </div>
    
        <!-- חלק שאר האופציות -->
        <div id="other-options" style="display: none;">
            <div class="budget-header" id="budget-header" style="display: none;">
                <h2 id="header-budget">סך התקציב: 0 ש"ח</h2>
                <span class="edit-icon" id="edit-budget">✏️</span>
            </div>
    
            <form id="budget-form">
                <div class="form-group">
                    <label for="expense-type">סוג הוצאה:</label>
                    <select id="expense-type">
                        <option value="">בחר סוג הוצאה</option>
                        <option value="קניות בסופר">קניות בסופר</option>
                        <option value="תשלום חשמל">תשלום חשמל</option>
                        <option value="דלק">דלק</option>
                        <option value="בילוי">בילוי</option>
                        <option value="אחר">אחר...</option>
                    </select>
                </div>
                <div class="form-group" id="custom-expense-group" style="display: none;">
                    <label for="custom-expense">סוג הוצאה מותאם:</label>
                    <input type="text" id="custom-expense" placeholder="הזן סוג הוצאה חדש">
                </div>
                <div class="form-group">
                    <label for="expense-amount">סכום הוצאה:</label>
                    <input type="text" id="expense-amount" placeholder="הזן את סכום ההוצאה" required>
                </div>
                <button type="button" id="add-expense">הוסף הוצאה</button>
            </form>
    
            <div class="budget-summary">
                <p><strong>סך התקציב:</strong> <span id="display-total">0</span> ש"ח</p>
                <p><strong>סך ההוצאות:</strong> <span id="display-expenses">0</span> ש"ח</p>
                <p><strong>תקציב נותר:</strong> <span id="display-remaining">0</span> ש"ח</p>
            </div>
    
            <div class="expense-list">
                <h3>רשימת הוצאות:</h3>
                <ul id="expense-list"></ul>
            </div>
        </div>
    </div>
    
    <script>


// הסתרה ראשונית של שאר האפשרויות
document.getElementById('other-options').style.display = 'none';


        // משתנים
        let totalBudget = 0;
        let totalExpenses = 0;

        // אלמנטים מה-HTML
        const totalBudgetInput = document.getElementById('total-budget');
        const setBudgetButton = document.getElementById('set-budget');
        const budgetHeader = document.getElementById('budget-header');
        const headerBudget = document.getElementById('header-budget');
        const editBudgetIcon = document.getElementById('edit-budget');

        const expenseTypeInput = document.getElementById('expense-type');
        const customExpenseGroup = document.getElementById('custom-expense-group');
        const customExpenseInput = document.getElementById('custom-expense');
        const expenseAmountInput = document.getElementById('expense-amount');
        const addExpenseButton = document.getElementById('add-expense');
        const displayTotal = document.getElementById('display-total');
        const displayExpenses = document.getElementById('display-expenses');
        const displayRemaining = document.getElementById('display-remaining');
        const expenseList = document.getElementById('expense-list');

        // שמירת התקציב הראשוני
setBudgetButton.addEventListener('click', () => {
    totalBudget = parseFloat(totalBudgetInput.value.replace(/,/g, '')) || 0;

    if (totalBudget > 0) {
        updateDisplay();
        headerBudget.textContent = `סך התקציב: ${formatNumber(totalBudget)} ש"ח`;
        budgetHeader.style.display = 'flex';

        // הסתרת חלק התקציב הראשוני
        document.getElementById('budget-input-group').style.display = 'none';

        // הצגת שאר האפשרויות
        document.getElementById('other-options').style.display = 'block';
    } else {
        alert('אנא הזן תקציב חוקי.');
    }
});


        // שמירת התקציב הראשוני
        setBudgetButton.addEventListener('click', () => {
            totalBudget = parseFloat(totalBudgetInput.value.replace(/,/g, '')) || 0;
            updateDisplay();
            headerBudget.textContent = `סך התקציב: ${formatNumber(totalBudget)} ש"ח`;
            budgetHeader.style.display = 'flex';
            document.getElementById('budget-input-group').style.display = 'none';
        });

        // עריכת התקציב
        editBudgetIcon.addEventListener('click', () => {
            document.getElementById('budget-input-group').style.display = 'block';
            totalBudgetInput.value = formatNumber(totalBudget);
        });

        // הצגת שדה סוג הוצאה מותאם אישית
        expenseTypeInput.addEventListener('change', () => {
            if (expenseTypeInput.value === 'אחר') {
                customExpenseGroup.style.display = 'block';
            } else {
                customExpenseGroup.style.display = 'none';
                customExpenseInput.value = '';
            }
        });

        // הוספת הוצאה
        addExpenseButton.addEventListener('click', () => {
            const expenseType = expenseTypeInput.value === 'אחר' ? customExpenseInput.value : expenseTypeInput.value;
            let expenseAmount = parseFloat(expenseAmountInput.value.replace(/,/g, '')) || 0;

            if (!expenseType || expenseAmount <= 0) {
                alert('אנא הזן סוג הוצאה וסכום תקף.');
                return;
            }

            totalExpenses += expenseAmount;

            // הוספת הוצאה לרשימה
            const listItem = document.createElement('li');
            listItem.innerHTML = `${expenseType} - ${formatNumber(expenseAmount)} ש"ח
                <div class="expense-actions">
                    <span class="edit-expense">✏️</span>
                    <span class="delete-expense">🗑️</span>
                </div>`;

            expenseList.appendChild(listItem);

            const editButton = listItem.querySelector('.edit-expense');
            const deleteButton = listItem.querySelector('.delete-expense');

           // עריכת הוצאה
editButton.addEventListener('click', () => {
    const newAmount = prompt('עדכן את סכום ההוצאה:', expenseAmount);
    if (newAmount && !isNaN(newAmount) && parseFloat(newAmount) >= 0) {
        totalExpenses -= expenseAmount;
        expenseAmount = parseFloat(newAmount);
        totalExpenses += expenseAmount;

        listItem.innerHTML = `${expenseType} - ${formatNumber(expenseAmount)} ש"ח
            <div class="expense-actions">
                <span class="edit-expense">✏️</span>
                <span class="delete-expense">🗑️</span>
            </div>`;
        updateDisplay();

        // מציאת הכפתורים החדשים
        const newEditButton = listItem.querySelector('.edit-expense');
        const newDeleteButton = listItem.querySelector('.delete-expense');

        // חיבור מאזינים מחדש
        newEditButton.addEventListener('click', () => editButton.click());
        newDeleteButton.addEventListener('click', () => {
            totalExpenses -= expenseAmount;
            if (totalExpenses < 0) totalExpenses = 0; // מניעת סכום שלילי
            listItem.remove();
            updateDisplay();
        });
    }
});


            // מחיקת הוצאה
            deleteButton.addEventListener('click', () => {
                totalExpenses -= expenseAmount;
                if (totalExpenses < 0) totalExpenses = 0; // מניעת סכום שלילי
                listItem.remove();
                updateDisplay();
            });

            expenseTypeInput.value = '';
            customExpenseInput.value = '';
            expenseAmountInput.value = '';
            customExpenseGroup.style.display = 'none';

            updateDisplay();
        });

        // עדכון תצוגה
        function updateDisplay() {
            displayTotal.textContent = formatNumber(totalBudget);
            displayExpenses.textContent = formatNumber(totalExpenses);
            displayRemaining.textContent = formatNumber(totalBudget - totalExpenses);
        }

        // הוספת פיסוק בשדה הקלט בזמן הזנה
        totalBudgetInput.addEventListener('input', () => {
            totalBudgetInput.value = formatInput(totalBudgetInput.value);
        });

        expenseAmountInput.addEventListener('input', () => {
            expenseAmountInput.value = formatInput(expenseAmountInput.value);
        });

        // פונקציות לפורמט מספרים
        function formatNumber(number) {
            return number.toLocaleString('he-IL');
        }

        function formatInput(value) {
            return value.replace(/,/g, '').replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
    </script>
</body>
</html>
